package dropbox.core.v1.services;

import "fender/v1.proto";
import "fender/v1/field_options.proto";
import "dropbox/core/v1/data/file.proto";

message MetadataRequest {
  /** The path to the file or folder. */
  optional string path = 1 [(fender.v1.fender_field).present = true];

  /**
  * Default is 10,000 (max is 25,000).
  * When listing a folder, the service won't report listings containing more than the specified amount of files and will instead respond with a 406 (Not Acceptable) status response.
  */
  optional uint32 file_limit = 2 [default=10000, (fender.v1.fender_field).max = 25000];

  /**
  * Each call to Metadata on a folder will return a hash field, generated by hashing all of the metadata contained in that response.
  * On later calls to Metadata, you should provide that value via this parameter so that if nothing has changed, the response will be a 304 (Not Modified) status code instead of the full, potentially very large, folder listing.
  * This parameter is ignored if the specified path is associated with a file or if list=false
  */
  optional string hash = 3;

  /**
  * If true, the folder's metadata will include a contents field with a list of metadata entries for the contents of the folder. 
  * If false, the contents field will be omitted.
  */
  optional string list = 4 [default="true"];

  /** 
  * Only applicable when list is set.
  * If this parameter is set to true, then contents will include the metadata of deleted children. 
  * Note that the target of the metadata call is always returned even when it has been deleted (with is_deleted set to true) regardless of this flag.
  */
  optional bool include_deleted = 5 [default=false];

  /**
  * If you include a particular revision number, then only the metadata for that revision will be returned.
  */
  optional string rev = 6;

  /**
  * The metadata returned will have its size field translated based on the given locale.
  */
  optional string locale = 7 [default="en-US"];

  /**
  * If true, each file will include a photo_info dictionary for photos and a video_info dictionary for videos with additional media info.
  * If the data isn't available yet, the string pending will be returned instead of a dictionary.
  */
  optional bool include_media_info = 8 [default=false];

  /**
  * If true, metadata for a shared folder will include a list of the members of the shared folder.
  * This is not enabled by default. You may need to see the [dropbox docs](https://www.dropbox.com/developers/core/docs#metadata) to get setup.
  */
  optional bool include_membership = 9 [default=false];
}

service FilesService {
  option (fender.v1.fender_service) = {
    address: "https://api.dropbox.com",
    transport: HTTPS,
    request_format: JSON
  };

  rpc Metadata (MetadataRequest) returns (data.FileMetadata) {
    option (fender.v1.fender_method) = {
      http_method: GET,
      http_path: "/1/metadata/auto/{+path}"
    };
  }
}

